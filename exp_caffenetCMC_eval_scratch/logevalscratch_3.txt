Namespace(batch_size=128, beta1=0.5, beta2=0.999, crop_low=0.08, data_folder='/dev/shm/UCF101/UCF101_split3/', dist_backend='nccl', dist_url='tcp://224.66.41.62:23456', epochs=200, evaluate=True, gpu=None, layer=5, learning_rate=0.01, log='time_linear.txt', lr_decay_epochs=[150, 200], lr_decay_rate=0.1, model='caffenet', model_name='calibrated_memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128_bsz_128_lr_0.01_decay_0.0005', model_path='exp_caffenetCMC/memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128/ckpt_epoch_300.pth', momentum=0.9, multiprocessing_distributed=False, num_workers=32, print_freq=10, rank=-1, resume='exp_caffenetCMC_eval_scratch/calibrated_memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128_bsz_128_lr_0.01_decay_0.0005/ckpt_epoch_300.pth', save_folder='exp_caffenetCMC_eval_scratch/calibrated_memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128_bsz_128_lr_0.01_decay_0.0005', save_freq=5, save_path='exp_caffenetCMC_eval_scratch', scratch=False, seed=None, tb_folder='exp_caffenetCMC_eval_scratch/tb_path/calibrated_memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128_bsz_128_lr_0.01_decay_0.0005_layer5', tb_freq=500, tb_path='exp_caffenetCMC_eval_scratch/tb_path/', ten_crop=True, weight_decay=0.0005, world_size=-1)
==> loading pre-trained model
==> done
CaffeNet_BN(
  (features): Sequential(
    (0): Conv2d(3, 96, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace)
    (2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Conv2d(96, 256, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (5): ReLU(inplace)
    (6): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (8): Conv2d(256, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): ReLU(inplace)
    (10): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (11): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (12): ReLU(inplace)
    (13): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): ReLU(inplace)
    (16): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (17): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (fc6): Sequential(
    (0): Dropout(p=0.5)
    (1): Linear(in_features=9216, out_features=4096, bias=True)
    (2): ReLU(inplace)
  )
  (fc7): Sequential(
    (0): Dropout(p=0.5)
    (1): Linear(in_features=4096, out_features=4096, bias=True)
  )
  (fc8): Sequential(
    (0): ReLU(inplace)
    (1): Linear(in_features=4096, out_features=101, bias=True)
  )
)
=> loading checkpoint 'exp_caffenetCMC_eval_scratch/calibrated_memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128_bsz_128_lr_0.01_decay_0.0005/ckpt_epoch_300.pth'
=> loaded checkpoint 'exp_caffenetCMC_eval_scratch/calibrated_memory_nce_caffenet_lr_0.001_decay_0.0001_bsz_128_bsz_128_lr_0.01_decay_0.0005/ckpt_epoch_300.pth' (epoch 300)
[CHANGED Jul 18, 2018] Now RESIZE(INT) keeps the aspect ratio of input!!!
orignal dataset len = 9624
new dataset len =  9624
[CHANGED Jul 18, 2018] Now RESIZE(INT) keeps the aspect ratio of input!!!
[CHANGED Jul 18, 2018] Now RESIZE(INT) keeps the aspect ratio of input!!!
orignal dataset len = 3696
new dataset len =  3696
number of train: 9624
number of val: 3696
==> testing...
Test: [0/924]	Time 74.327 (74.327)	Loss 5.2202 (5.2202)	Acc@1 0.000 (0.000)	Acc@5 75.000 (75.000)
Test: [10/924]	Time 0.035 (6.803)	Loss 5.1204 (2.6132)	Acc@1 0.000 (43.182)	Acc@5 75.000 (86.364)
Test: [20/924]	Time 0.041 (3.581)	Loss 6.4220 (3.3401)	Acc@1 0.000 (36.905)	Acc@5 0.000 (66.667)
Test: [30/924]	Time 0.047 (2.438)	Loss 2.0316 (4.1006)	Acc@1 50.000 (28.226)	Acc@5 75.000 (58.065)
Test: [40/924]	Time 0.045 (1.854)	Loss 0.4042 (3.6190)	Acc@1 75.000 (33.537)	Acc@5 100.000 (64.024)
Test: [50/924]	Time 0.038 (1.498)	Loss 0.0332 (3.1521)	Acc@1 100.000 (40.196)	Acc@5 100.000 (68.137)
Test: [60/924]	Time 0.043 (1.260)	Loss 0.0024 (2.9319)	Acc@1 100.000 (46.311)	Acc@5 100.000 (70.492)
Test: [70/924]	Time 1.532 (1.187)	Loss 4.8431 (2.9382)	Acc@1 25.000 (46.479)	Acc@5 50.000 (68.662)
Test: [80/924]	Time 1.136 (1.077)	Loss 0.0148 (2.7563)	Acc@1 100.000 (49.383)	Acc@5 100.000 (70.679)
Test: [90/924]	Time 0.035 (0.973)	Loss 1.7739 (2.6717)	Acc@1 75.000 (49.725)	Acc@5 75.000 (70.055)
Test: [100/924]	Time 0.034 (0.954)	Loss 0.5388 (2.6733)	Acc@1 75.000 (51.238)	Acc@5 100.000 (70.297)
Test: [110/924]	Time 0.037 (0.872)	Loss 0.0001 (2.4683)	Acc@1 100.000 (54.955)	Acc@5 100.000 (72.748)
Test: [120/924]	Time 0.035 (0.822)	Loss 1.2294 (2.3777)	Acc@1 50.000 (55.992)	Acc@5 100.000 (74.174)
Test: [130/924]	Time 0.118 (0.774)	Loss 0.7150 (2.2543)	Acc@1 75.000 (57.634)	Acc@5 100.000 (75.954)
Test: [140/924]	Time 0.326 (0.743)	Loss 0.1732 (2.5137)	Acc@1 100.000 (55.851)	Acc@5 100.000 (73.759)
Test: [150/924]	Time 0.283 (0.716)	Loss 1.9636 (2.3686)	Acc@1 25.000 (58.113)	Acc@5 75.000 (75.331)
Test: [160/924]	Time 0.300 (0.691)	Loss 3.0867 (2.4285)	Acc@1 0.000 (55.280)	Acc@5 100.000 (74.379)
Test: [170/924]	Time 0.033 (0.670)	Loss 6.7097 (2.5124)	Acc@1 0.000 (53.947)	Acc@5 0.000 (73.246)
Test: [180/924]	Time 0.032 (0.654)	Loss 3.4853 (2.4648)	Acc@1 0.000 (54.282)	Acc@5 50.000 (73.619)
Test: [190/924]	Time 0.531 (0.636)	Loss 0.0210 (2.5801)	Acc@1 100.000 (52.749)	Acc@5 100.000 (71.728)
Test: [200/924]	Time 0.331 (0.620)	Loss 4.8582 (2.5773)	Acc@1 0.000 (52.861)	Acc@5 100.000 (71.766)
Test: [210/924]	Time 0.345 (0.607)	Loss 3.8598 (2.5656)	Acc@1 0.000 (53.081)	Acc@5 75.000 (72.393)
Test: [220/924]	Time 0.368 (0.595)	Loss 5.9142 (2.6876)	Acc@1 0.000 (50.679)	Acc@5 100.000 (72.398)
Test: [230/924]	Time 0.320 (0.583)	Loss 6.6097 (2.7030)	Acc@1 0.000 (50.325)	Acc@5 0.000 (72.186)
Test: [240/924]	Time 0.687 (0.575)	Loss 0.0009 (2.6176)	Acc@1 100.000 (51.349)	Acc@5 100.000 (73.237)
Test: [250/924]	Time 0.921 (0.567)	Loss 0.1855 (2.6140)	Acc@1 100.000 (50.100)	Acc@5 100.000 (72.908)
Test: [260/924]	Time 0.373 (0.555)	Loss 5.0999 (2.6179)	Acc@1 0.000 (49.617)	Acc@5 50.000 (73.084)
Test: [270/924]	Time 0.358 (0.547)	Loss 0.2846 (2.5538)	Acc@1 100.000 (50.646)	Acc@5 100.000 (73.893)
Test: [280/924]	Time 0.320 (0.539)	Loss 0.4397 (2.4848)	Acc@1 75.000 (51.779)	Acc@5 100.000 (74.555)
Test: [290/924]	Time 0.337 (0.532)	Loss 1.3989 (2.4273)	Acc@1 25.000 (52.320)	Acc@5 100.000 (75.430)
Test: [300/924]	Time 0.341 (0.526)	Loss 1.7298 (2.3929)	Acc@1 50.000 (52.159)	Acc@5 100.000 (76.163)
Test: [310/924]	Time 0.342 (0.520)	Loss 3.2712 (2.4184)	Acc@1 25.000 (51.608)	Acc@5 100.000 (76.206)
Test: [320/924]	Time 0.350 (0.514)	Loss 0.2396 (2.4165)	Acc@1 100.000 (51.869)	Acc@5 100.000 (76.324)
Test: [330/924]	Time 0.035 (0.509)	Loss 2.6034 (2.4358)	Acc@1 50.000 (51.057)	Acc@5 50.000 (75.680)
Test: [340/924]	Time 0.410 (0.504)	Loss 3.4029 (2.5426)	Acc@1 0.000 (49.560)	Acc@5 75.000 (73.974)
Test: [350/924]	Time 0.324 (0.499)	Loss 7.0956 (2.6267)	Acc@1 0.000 (48.433)	Acc@5 0.000 (72.650)
Test: [360/924]	Time 0.329 (0.494)	Loss 1.3456 (2.6875)	Acc@1 75.000 (47.715)	Acc@5 75.000 (71.884)
Test: [370/924]	Time 0.349 (0.490)	Loss 0.1921 (2.6456)	Acc@1 100.000 (48.181)	Acc@5 100.000 (72.574)
Test: [380/924]	Time 0.035 (0.486)	Loss 1.4231 (2.5813)	Acc@1 25.000 (49.278)	Acc@5 100.000 (73.294)
Test: [390/924]	Time 0.308 (0.483)	Loss 1.3663 (2.5206)	Acc@1 75.000 (50.512)	Acc@5 75.000 (73.913)
Test: [400/924]	Time 0.352 (0.479)	Loss 0.0009 (2.5662)	Acc@1 100.000 (50.374)	Acc@5 100.000 (73.317)
Test: [410/924]	Time 0.336 (0.476)	Loss 0.7845 (2.5075)	Acc@1 75.000 (51.460)	Acc@5 100.000 (73.966)
Test: [420/924]	Time 0.312 (0.472)	Loss 7.1732 (2.5106)	Acc@1 0.000 (51.485)	Acc@5 0.000 (74.169)
Test: [430/924]	Time 0.349 (0.469)	Loss 4.8150 (2.6007)	Acc@1 0.000 (50.348)	Acc@5 0.000 (73.028)
Test: [440/924]	Time 0.325 (0.466)	Loss 9.1896 (2.6480)	Acc@1 0.000 (50.113)	Acc@5 0.000 (72.449)
Test: [450/924]	Time 0.324 (0.463)	Loss 0.5402 (2.6768)	Acc@1 75.000 (49.945)	Acc@5 100.000 (72.616)
Test: [460/924]	Time 0.301 (0.461)	Loss 0.3124 (2.6314)	Acc@1 75.000 (50.434)	Acc@5 100.000 (73.210)
Test: [470/924]	Time 0.342 (0.458)	Loss 0.1840 (2.5944)	Acc@1 100.000 (50.637)	Acc@5 100.000 (73.779)
Test: [480/924]	Time 0.321 (0.456)	Loss 2.0570 (2.6073)	Acc@1 50.000 (50.728)	Acc@5 50.000 (73.649)
Test: [490/924]	Time 0.034 (0.453)	Loss 1.6307 (2.5817)	Acc@1 50.000 (51.120)	Acc@5 100.000 (73.880)
Test: [500/924]	Time 0.340 (0.451)	Loss 2.5387 (2.6228)	Acc@1 0.000 (50.349)	Acc@5 75.000 (73.303)
Test: [510/924]	Time 0.343 (0.449)	Loss 2.5984 (2.6560)	Acc@1 0.000 (49.658)	Acc@5 100.000 (72.896)
Test: [520/924]	Time 0.305 (0.447)	Loss 0.5480 (2.6402)	Acc@1 75.000 (49.808)	Acc@5 100.000 (73.129)
Test: [530/924]	Time 0.363 (0.445)	Loss 2.9227 (2.6784)	Acc@1 0.000 (49.011)	Acc@5 75.000 (72.599)
Test: [540/924]	Time 0.352 (0.443)	Loss 6.7940 (2.6777)	Acc@1 0.000 (48.521)	Acc@5 0.000 (72.828)
Test: [550/924]	Time 0.312 (0.441)	Loss 6.3284 (2.7247)	Acc@1 25.000 (48.185)	Acc@5 25.000 (72.142)
Test: [560/924]	Time 0.356 (0.439)	Loss 7.4427 (2.7629)	Acc@1 0.000 (47.638)	Acc@5 0.000 (71.346)
Test: [570/924]	Time 0.333 (0.438)	Loss 7.7155 (2.7861)	Acc@1 0.000 (47.636)	Acc@5 0.000 (71.103)
Test: [580/924]	Time 0.312 (0.436)	Loss 0.0249 (2.7962)	Acc@1 100.000 (47.332)	Acc@5 100.000 (70.611)
Test: [590/924]	Time 0.351 (0.434)	Loss 0.0031 (2.7600)	Acc@1 100.000 (47.800)	Acc@5 100.000 (71.108)
Test: [600/924]	Time 0.328 (0.433)	Loss 0.0067 (2.7424)	Acc@1 100.000 (48.003)	Acc@5 100.000 (71.215)
Test: [610/924]	Time 0.317 (0.431)	Loss 2.5312 (2.7620)	Acc@1 25.000 (47.668)	Acc@5 100.000 (71.154)
Test: [620/924]	Time 0.318 (0.430)	Loss 0.2372 (2.7539)	Acc@1 100.000 (47.504)	Acc@5 100.000 (71.337)
Test: [630/924]	Time 0.347 (0.428)	Loss 0.0106 (2.7160)	Acc@1 100.000 (48.177)	Acc@5 100.000 (71.791)
Test: [640/924]	Time 0.366 (0.427)	Loss 9.0244 (2.7552)	Acc@1 0.000 (47.660)	Acc@5 25.000 (71.451)
Test: [650/924]	Time 0.034 (0.426)	Loss 0.3108 (2.7672)	Acc@1 75.000 (47.619)	Acc@5 100.000 (71.237)
Test: [660/924]	Time 0.348 (0.425)	Loss 9.6653 (2.7624)	Acc@1 0.000 (47.882)	Acc@5 0.000 (71.218)
Test: [670/924]	Time 0.327 (0.423)	Loss 0.1778 (2.7652)	Acc@1 100.000 (48.137)	Acc@5 100.000 (71.125)
Test: [680/924]	Time 0.306 (0.422)	Loss 2.3643 (2.7551)	Acc@1 50.000 (48.238)	Acc@5 100.000 (71.182)
Test: [690/924]	Time 0.344 (0.421)	Loss 7.4781 (2.7773)	Acc@1 0.000 (47.757)	Acc@5 0.000 (70.767)
Test: [700/924]	Time 0.325 (0.420)	Loss 2.3704 (2.7584)	Acc@1 25.000 (47.896)	Acc@5 50.000 (71.006)
Test: [710/924]	Time 0.311 (0.419)	Loss 3.4833 (2.7539)	Acc@1 25.000 (47.785)	Acc@5 75.000 (70.851)
Test: [720/924]	Time 0.359 (0.418)	Loss 5.4332 (2.7897)	Acc@1 25.000 (47.157)	Acc@5 50.000 (70.458)
Test: [730/924]	Time 0.340 (0.417)	Loss 1.2066 (2.8296)	Acc@1 50.000 (46.751)	Acc@5 100.000 (69.904)
Test: [740/924]	Time 0.335 (0.416)	Loss 0.3719 (2.7966)	Acc@1 100.000 (47.335)	Acc@5 100.000 (70.310)
Test: [750/924]	Time 0.388 (0.415)	Loss 0.0859 (2.7674)	Acc@1 100.000 (47.803)	Acc@5 100.000 (70.639)
Test: [760/924]	Time 0.326 (0.414)	Loss 1.4831 (2.7567)	Acc@1 75.000 (48.029)	Acc@5 75.000 (70.696)
Test: [770/924]	Time 0.337 (0.413)	Loss 4.0340 (2.7935)	Acc@1 25.000 (47.763)	Acc@5 25.000 (70.233)
Test: [780/924]	Time 0.298 (0.412)	Loss 0.0003 (2.7820)	Acc@1 100.000 (48.079)	Acc@5 100.000 (70.294)
Test: [790/924]	Time 0.340 (0.411)	Loss 6.3701 (2.7856)	Acc@1 25.000 (48.135)	Acc@5 25.000 (70.259)
Test: [800/924]	Time 0.334 (0.410)	Loss 2.2310 (2.7583)	Acc@1 0.000 (48.533)	Acc@5 100.000 (70.630)
Test: [810/924]	Time 0.035 (0.409)	Loss 0.3820 (2.7376)	Acc@1 75.000 (48.767)	Acc@5 100.000 (70.993)
Test: [820/924]	Time 0.345 (0.408)	Loss 4.8890 (2.7464)	Acc@1 0.000 (48.447)	Acc@5 0.000 (70.737)
Test: [830/924]	Time 0.332 (0.407)	Loss 1.8404 (2.7782)	Acc@1 25.000 (48.135)	Acc@5 100.000 (70.337)
Test: [840/924]	Time 0.306 (0.407)	Loss 0.0065 (2.7820)	Acc@1 100.000 (47.979)	Acc@5 100.000 (70.303)
Test: [850/924]	Time 0.351 (0.406)	Loss 2.9004 (2.7725)	Acc@1 50.000 (48.002)	Acc@5 75.000 (70.358)
Test: [860/924]	Time 0.323 (0.405)	Loss 1.9347 (2.7616)	Acc@1 50.000 (48.084)	Acc@5 100.000 (70.499)
Test: [870/924]	Time 0.294 (0.404)	Loss 2.5347 (2.7609)	Acc@1 50.000 (47.933)	Acc@5 100.000 (70.666)
Test: [880/924]	Time 0.338 (0.403)	Loss 0.1520 (2.7449)	Acc@1 100.000 (48.297)	Acc@5 100.000 (70.914)
Test: [890/924]	Time 0.314 (0.402)	Loss 1.4926 (2.7292)	Acc@1 50.000 (48.541)	Acc@5 100.000 (71.072)
Test: [900/924]	Time 0.296 (0.401)	Loss 4.3638 (2.7277)	Acc@1 0.000 (48.529)	Acc@5 0.000 (70.977)
Test: [910/924]	Time 0.349 (0.401)	Loss 4.2190 (2.7444)	Acc@1 25.000 (48.436)	Acc@5 75.000 (70.884)
Test: [920/924]	Time 0.338 (0.400)	Loss 5.5842 (2.7319)	Acc@1 0.000 (48.670)	Acc@5 0.000 (70.928)
 * Acc@1 48.674 Acc@5 70.996
